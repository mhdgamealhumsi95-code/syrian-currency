<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø­ÙˆÙ„ Ø§Ù„Ù„ÙŠØ±Ø© Ø§Ù„Ø³ÙˆØ±ÙŠØ©</title>
    
    <link rel="manifest" href="manifest.json">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@500;700;800&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-color: #013430;
            --gold-color: #C5A065;
            --white-color: #FFFFFF;
            --input-bg: #F5F5F5;
            --btn-hover: #b08d55;
            --red-alert: #d63031;
            --green-success: #00b894;
        }

        body {
            background-color: var(--bg-color);
            font-family: 'Tajawal', sans-serif;
            margin: 0;
            padding: 20px 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .eagle-container { margin-bottom: 20px; text-align: center; }
        .eagle-icon { width: 100px; height: auto; fill: var(--gold-color); }

        h1 {
            color: var(--white-color);
            font-size: 1.8rem;
            font-weight: 800;
            margin: 0 0 20px 0;
            text-align: center;
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙƒØ±Øª Ø§Ù„Ø¹Ø§Ù… */
        .card {
           .card {
            background-color: var(--white-color);
            width: 90%;
            max-width: 450px; /* ğŸ‘ˆ (Ù…Ù‡Ù…) ØµØºØ±Ù†Ø§ Ø§Ù„Ø±Ù‚Ù… Ù„ÙŠØµÙŠØ± Ø¨Ø­Ø¬Ù… Ø§Ù„Ø¬ÙˆØ§Ù„ */
            border-radius: 25px;
            padding: 30px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }
        }

        .card-title {
            color: #998353;
            font-size: 1.2rem;
            font-weight: 800;
            margin-bottom: 20px;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }

        /* --- 1. ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ø­ÙˆÙ„ Ø§Ù„Ù‚Ø¯ÙŠÙ… (Ø§Ù„Ù…Ø³ØªØ¹Ø§Ø¯Ø©) --- */
        .converter-wrapper {
            display: flex;
            display: flex; 
            flex-direction: column; /* ğŸ‘ˆ Ø¬Ø¹Ù„Ù†Ø§ Ø®Ø§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ø³Ø¨Ø© ÙÙˆÙ‚ Ø¨Ø¹Ø¶ Ø£ÙŠØ¶Ø§Ù‹ */
            gap: 10px;
            margin-bottom: 20px;
        }

       .input-box-container {
            position: relative;
            width: 100%;
        }

        .main-input {
            width: 100%;
            padding: 15px;
            padding-left: 50px;
            font-size: 1.1rem;
            border: 2px solid var(--gold-color);
            border-radius: 20px;
            background-color: var(--input-bg);
            color: #333;
            font-family: 'Tajawal', sans-serif;
            font-weight: bold;
            text-align: right;
            outline: none;
            box-sizing: border-box;
            transition: 0.3s;
        }

        .main-input:focus { box-shadow: 0 0 10px rgba(197, 160, 101, 0.3); }

        .currency-tag {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #888;
            font-weight: bold;
            font-size: 0.9rem;
        }

        /* Ø²Ø± Ø§Ù„Ù†Ø³Ø® */
        .copy-btn {
            position: absolute;
            left: 55px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.2rem;
            padding: 5px;
            border-radius: 5px;
            transition: 0.2s;
        }
        .copy-btn:active { transform: translateY(-50%) scale(0.9); }

        .swap-arrow { color: var(--gold-color); 
            font-size: 1.8rem; 
            transform: rotate(90deg); /* ğŸ‘ˆ ØªØ¯ÙˆÙŠØ± 90 Ø¯Ø±Ø¬Ø© */
            margin: 5px 0; }

        /* Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª */
        .history-section {
            margin-top: 20px;
            border-top: 1px solid #eee;
            padding-top: 15px;
            font-size: 0.9rem;
            color: #666;
            text-align: right;
            display: none; /* Ù…Ø®ÙÙŠ Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ */
        }
        .history-title { font-weight: bold; color: var(--gold-color); margin-bottom: 10px; text-align: center; }
        .history-list { list-style: none; padding: 0; margin: 0; }
        .history-item {
            display: flex; justify-content: space-between;
            background: #f9f9f9; margin-bottom: 5px; padding: 8px 15px; border-radius: 10px;
        }

        /* --- 2. ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¨Ø§Ù‚ÙŠ --- */
        .input-group { margin-bottom: 20px; text-align: right; }
        .label-text { font-size: 0.9rem; color: #666; margin-bottom: 5px; display: block; font-weight: bold; }
        .flex-row { display: flex; gap: 10px; }
        
        .calc-input { flex: 2; padding: 15px; border: 2px solid #ddd; border-radius: 15px; font-family: 'Tajawal', sans-serif; font-size: 1.1rem; }
        .calc-select { flex: 1; padding: 10px; border: 2px solid #ccc; border-radius: 15px; font-family: 'Tajawal', sans-serif; cursor: pointer; }

        .result-box {
            background-color: #f0fdf4; border: 2px dashed var(--green-success);
            border-radius: 15px; padding: 20px; margin-top: 20px; display: none;
        }
        .result-amount { font-size: 1.4rem; font-weight: 800; color: var(--green-success); }
        .error-box {
            background-color: #fff0f0; border: 2px solid var(--red-alert); color: var(--red-alert);
            padding: 10px; border-radius: 10px; margin-top: 10px; display: none; font-weight: bold;
        }

        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª */
        .actions-container { display: flex; justify-content: center; gap: 10px; margin-top: 10px; flex-wrap: wrap;}
        .action-btn {
            background-color: var(--gold-color); color: white; border: none; padding: 10px 20px;
            border-radius: 50px; font-family: 'Tajawal', sans-serif; cursor: pointer; font-size: 0.9rem;
        }
        .btn-green { background-color: #25D366; }
        #installBtn { display: none; background-color: #333; }

        /* Ù…ÙˆØ¨Ø§ÙŠÙ„ */
        @media (max-width: 700px) {
            .converter-wrapper, .flex-row { flex-direction: column; }
            .input-box-container, .calc-select, .calc-input { width: 100%; }
            .swap-arrow { transform: rotate(90deg); margin: 10px 0; }
        }
    </style>
</head>
<body>

    <div class="eagle-container">
       <img src="logo.png" class="eagle-icon" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ù†Ø³Ø±">
    </div>

    <h1>ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù„ÙŠØ±Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</h1>

    <div class="card">
        <div class="card-title">Ø§Ù„Ù„ÙŠØ±Ø© Ø§Ù„Ø³ÙˆØ±ÙŠØ© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© ÙˆÙ…Ø§ ÙŠØ¹Ø§Ø¯Ù„Ù‡Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</div>

        <div class="converter-wrapper">
            
            <div class="input-box-container">
                <input type="number" class="main-input" id="oldAmount" placeholder="Ø§Ø¯Ø®Ù„ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©" oninput="handleInput('old')">
                <span class="currency-tag">Ù„.Ø³</span>
            </div>

            <div class="swap-arrow">â‡„</div>

            <div class="input-box-container">
                <input type="number" class="main-input" id="newAmount" placeholder="Ù‚ÙŠÙ…ØªÙ‡Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©" oninput="handleInput('new')">
                <button class="copy-btn" onclick="copyResult()" title="Ù†Ø³Ø® Ø§Ù„Ù…Ø¨Ù„Øº">ğŸ“‹</button>
                <span class="currency-tag">Ù„.Ø³</span>
            </div>

        </div>

        <div class="history-section" id="historySection">
            <div class="history-title">Ø¢Ø®Ø± Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø­Ø³Ø§Ø¨ÙŠØ©</div>
            <ul class="history-list" id="historyList"></ul>
        </div>
    </div>

    <div class="card" style="border-top: 5px solid var(--gold-color);">
        <div class="card-title">ğŸ§® Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¨Ø§Ù‚ÙŠ (Ù…Ù†Ø¹ Ø§Ù„ØºØ´)</div>
        
        <div class="input-group">
            <span class="label-text">1. ÙƒÙ… Ø³Ø¹Ø± Ø§Ù„ØºØ±Ø¶ØŸ</span>
            <div class="flex-row">
                <input type="number" class="calc-input" id="itemPrice" placeholder="Ù…Ø«Ù„Ø§Ù‹: 8000" oninput="calculateChange()">
                <select id="priceCurrency" class="calc-select" onchange="calculateChange()">
                    <option value="old">Ù„ÙŠØ±Ø© Ù‚Ø¯ÙŠÙ…Ø©</option>
                    <option value="new">Ù„ÙŠØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©</option>
                </select>
            </div>
        </div>

        <div class="input-group">
            <span class="label-text">2. ÙƒÙ… Ø¯ÙØ¹Øª Ù„Ù„Ø¨Ø§Ø¦Ø¹ØŸ</span>
            <div class="flex-row">
                <input type="number" class="calc-input" id="paidAmount" placeholder="Ù…Ø«Ù„Ø§Ù‹: 100" oninput="calculateChange()">
                <select id="paidCurrency" class="calc-select" onchange="calculateChange()">
                    <option value="new">Ù„ÙŠØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©</option>
                    <option value="old">Ù„ÙŠØ±Ø© Ù‚Ø¯ÙŠÙ…Ø©</option>
                </select>
            </div>
        </div>

        <div id="resultBox" class="result-box">
            <div class="result-text">Ø§Ù„Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø°ÙŠ ÙŠØ¬Ø¨ Ø§Ø³ØªÙ„Ø§Ù…Ù‡:</div>
            <div class="result-amount" id="changeNew">0 Ù„.Ø³ Ø¬Ø¯ÙŠØ¯Ø©</div>
            <div style="font-size: 0.9rem; color:#666;">Ø£Ùˆ Ù…Ø§ ÙŠØ¹Ø§Ø¯Ù„Ù‡Ø§:</div>
            <div class="result-amount" style="color: #013430;" id="changeOld">0 Ù„.Ø³ Ù‚Ø¯ÙŠÙ…Ø©</div>
        </div>

        <div id="errorBox" class="error-box">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯ÙÙˆØ¹ Ø£Ù‚Ù„ Ù…Ù† Ø³Ø¹Ø± Ø§Ù„ØºØ±Ø¶!</div>
    </div>

    <div class="actions-container">
        <button class="action-btn btn-green" onclick="shareApp()">Ù†Ø´Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ğŸ“¢</button>
        <button id="installBtn" class="action-btn">ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ğŸ“²</button>
    </div>

    <div style="text-align: center; margin-top: 30px; color: rgba(255,255,255,0.6); font-size: 0.8rem;">
        ØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± Ø¨ÙˆØ§Ø³Ø·Ø© [Mohamad Alhumsi]
    </div>

    <script>
        // --- 1. ÙƒÙˆØ¯ Ø§Ù„Ù…Ø­ÙˆÙ„ Ø§Ù„Ù‚Ø¯ÙŠÙ… (Ù…Ø¹ Ø§Ù„Ø³Ø¬Ù„ ÙˆØ§Ù„Ù†Ø³Ø®) ---
        let debounceTimer;

        function handleInput(source) {
            const oldInput = document.getElementById('oldAmount');
            const newInput = document.getElementById('newAmount');
            let val = 0;

            if (source === 'old') {
                val = parseFloat(oldInput.value);
                if (!isNaN(val)) {
                    newInput.value = parseFloat((val / 100).toFixed(2));
                } else {
                    newInput.value = '';
                }
            } else {
                val = parseFloat(newInput.value);
                if (!isNaN(val)) {
                    oldInput.value = Math.round(val * 100);
                } else {
                    oldInput.value = '';
                }
            }

            // Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ø¬Ù„ Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØ©
            clearTimeout(debounceTimer);
            if (oldInput.value && newInput.value) {
                debounceTimer = setTimeout(() => {
                    addToHistory(oldInput.value, newInput.value);
                }, 1000);
            }
        }

        function copyResult() {
            const newVal = document.getElementById('newAmount');
            if (newVal.value) {
                navigator.clipboard.writeText(newVal.value).then(() => alert('ØªÙ… Ø§Ù„Ù†Ø³Ø®: ' + newVal.value));
            }
        }

        function addToHistory(oldVal, newVal) {
            const section = document.getElementById('historySection');
            const list = document.getElementById('historyList');
            section.style.display = 'block';
            
            const li = document.createElement('li');
            li.className = 'history-item';
            li.innerHTML = `<span>${Number(oldVal).toLocaleString()} Ù‚Ø¯ÙŠÙ…Ø©</span> <span>â¬…ï¸</span> <span>${Number(newVal).toLocaleString()} Ø¬Ø¯ÙŠØ¯Ø©</span>`;
            
            list.insertBefore(li, list.firstChild);
            if (list.children.length > 3) list.removeChild(list.lastChild);
        }

        // --- 2. ÙƒÙˆØ¯ Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø¨Ø§Ù‚ÙŠ (Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©) ---
        function calculateChange() {
            let price = parseFloat(document.getElementById('itemPrice').value);
            let priceType = document.getElementById('priceCurrency').value;
            let paid = parseFloat(document.getElementById('paidAmount').value);
            let paidType = document.getElementById('paidCurrency').value;
            
            const rBox = document.getElementById('resultBox');
            const eBox = document.getElementById('errorBox');

            if (isNaN(price) || isNaN(paid)) { rBox.style.display = 'none'; eBox.style.display = 'none'; return; }

            let priceInOld = (priceType === 'new') ? price * 100 : price;
            let paidInOld = (paidType === 'new') ? paid * 100 : paid;
            let changeInOld = paidInOld - priceInOld;

            if (changeInOld < 0) {
                rBox.style.display = 'none'; eBox.style.display = 'block';
                eBox.innerText = "Ø§Ù†ØªØ¨Ù‡: Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø¯ÙÙˆØ¹ Ù†Ø§Ù‚Øµ (" + Math.abs(changeInOld) + " Ù‚Ø¯ÙŠÙ…Ø©)";
            } else {
                eBox.style.display = 'none'; rBox.style.display = 'block';
                document.getElementById('changeNew').innerText = (changeInOld / 100).toLocaleString() + " Ù„.Ø³ (Ø¬Ø¯ÙŠØ¯Ø©)";
                document.getElementById('changeOld').innerText = changeInOld.toLocaleString() + " Ù„.Ø³ (Ù‚Ø¯ÙŠÙ…Ø©)";
            }
        }

        // --- 3. Ù†Ø´Ø± ÙˆØªØ«Ø¨ÙŠØª ---
        function shareApp() {
            if (navigator.share) navigator.share({title:'Ù…Ø­ÙˆÙ„ Ø§Ù„Ù„ÙŠØ±Ø©', url:window.location.href});
            else alert('Ø§Ù„Ø±Ø§Ø¨Ø·: ' + window.location.href);
        }

        let deferredPrompt;
        const installBtn = document.getElementById('installBtn');
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault(); deferredPrompt = e; installBtn.style.display = 'block';
        });
        installBtn.addEventListener('click', async () => {
            if(deferredPrompt) { deferredPrompt.prompt(); deferredPrompt = null; installBtn.style.display='none'; }
        });

        if ('serviceWorker' in navigator) window.addEventListener('load', () => navigator.serviceWorker.register('service-worker.js'));
    </script>
</body>
</html>

